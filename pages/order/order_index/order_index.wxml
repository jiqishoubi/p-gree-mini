<!-- 订单主页 -->
<view class="order_page">
  <!-- 固定 -->
  <view class="top">
    <!-- 搜索 -->
    <!-- <view class="search_wrap bg_white">
      <view class="search_content flexCenter">
        <van-icon name="search" 
          size="1.5em" 
          color="#9B9B9B"
        />
        <input class="search_input"
          placeholder="输入型号"
          confirm-type='搜索'
        ></input>
      </view>
    </view> -->

    <!-- 状态 -->
    <view class="nav">
      <view wx:for="{{navList}}" wx:key="index"
        class="nav_item{{navIndex==index?' active':''}}"
        bindtap="clickNav"
        data-index="{{index}}"
      >
        {{item.text}}
        <view wx:if="{{item.count}}" class="nav_count">{{item.count}}</view>
      </view>
    </view>
  </view>
  

  <!-- list -->
  <view class="list">
    <block>
      <view wx:for="{{showList}}" wx:key="index"
        class="item"
        bindtap="goDetail"
        data-item="{{item}}"
      >
        <!-- 认筹单接口 -->
        <view wx:if="{{navIndex==0||navIndex==1}}"
          class="item_title flexBetween van-hairline--bottom"
        >
          <view wx:if="{{item.orderDateStr}}">{{item.orderDateStr}}</view>
          <view wx:if="{{item.orderNo}}" class="datetime">{{item.orderNo}}</view>
        </view>
        <!-- 销售单接口 -->
        <view wx:if="{{navIndex==2||navIndex==3}}"
          class="item_title flexBetween van-hairline--bottom"
        >
          <view wx:if="{{item.tradeDateStr}}">{{item.tradeDateStr}}</view>
          <view wx:if="{{item.tradeNo}}" class="datetime">{{item.tradeNo}}</view>
        </view>

        <view wx:for="{{item.goodsList}}" wx:for-index="idx" wx:for-item="itm"
          wx:key="idx"
          class="item_content flexCenter flexBetween"
        >
          <view class="item_img_box">
            <image class="item_img" src="{{itm.logoImage}}" alt=''></image>
          </view>
          <view class="item_content_content">
            <!-- 家用认筹 -->
            <view wx:if="{{!item.custName}}"
              class="item_content_content_top"
            >
              <view class="item_content_title textOmit">{{itm.goodsName}}</view>
              <view class="item_content_desc textOmit" 
                catchtap="callPhone" 
                data-phone="{{itm.phoneNumber}}"
              >
                <text>{{itm.custName}}</text>
                <text decode="{{true}}">&nbsp;&nbsp;&nbsp;</text>
                <text wx:if="{{itm.phoneNumber}}">{{itm.phoneNumber}}</text>
                <van-icon wx:if="{{itm.phoneNumber}}"
                  name="phone" 
                  color='#00a6ff' 
                  style="margin-left:3rpx;position:relative;top:4rpx;" 
                />
              </view>
              <view class="item_content_desc textOmit">
                {{itm.provinceName}}{{itm.eparchyName}}{{itm.cityName}}{{itm.address}}
              </view>
            </view>
            <!-- 商用认筹 已登录 -->
            <view wx:if="{{item.custName}}"
              class="item_content_content_top"
            >
              <view class="item_content_title textOmit">{{itm.goodsName}}</view>
              <view class="item_content_desc textOmit" 
                catchtap="callPhone" 
                data-phone="{{item.phoneNumber}}"
              >
                <text>{{item.custName}}</text>
                <text decode="{{true}}">&nbsp;&nbsp;&nbsp;</text>
                <text wx:if="{{item.phoneNumber}}">{{item.phoneNumber}}</text>
                <van-icon wx:if="{{item.phoneNumber}}"
                  name="phone" 
                  color='#00a6ff' 
                  style="margin-left:3rpx;position:relative;top:4rpx;" 
                />
              </view>
              <view class="item_content_desc textOmit">
                {{item.provinceName}}{{item.eparchyName}}{{item.cityName}}{{item.address}}
              </view>
            </view>
            
            <!-- 认筹单接口 -->
            <view wx:if="{{navIndex==0||navIndex==1}}"
              class="yuan_wrap flexCenter flexBetween"
            >
              <view>
                <text wx:if="{{itm.priceFeeActivityYuan}}">{{itm.priceFeeActivityYuan}}元</text>
                <text wx:else>{{itm.priceFeeYuan}}元</text>
                <text wx:if="{{navIndex==1&&item.orderStatus==50}}"><text decode="{{true}}">&nbsp;</text>x{{itm.goodsCount}}</text>
              </view>
            </view>
            <!-- 销售单接口 -->
            <view wx:if="{{navIndex==2||navIndex==3}}"
              class="yuan_wrap flexCenter flexBetween"
            >
              <view>{{itm.tradeFeeStr}}元</view>
            </view>
          </view>
        </view>

        <view wx:if="{{navIndex==2}}" class="btn_wrap">
          <button class="btn"
            hover-class="btn_active"
            catchtap="openCancelModal"
            data-item="{{item}}"
          >退单</button>
        </view>
      </view>
    </block>
    
    <view wx:if="{{showList.length==0}}" class="noresult">暂无数据</view>
  </view>

  <view style="height:200rpx;"></view>


  <!-- tabbar -->
  <van-tabbar 
    active="{{2}}"
    active-color="#00A6FF"
    inactive-color="#fff"
    bind:change="onChange_tabbar"
  >
    <van-tabbar-item>
      <image
        slot="icon"
        src="https://cdn.s.bld365.com/getli_tab_icon_01.png"
        mode="aspectFit"
      />
      <image
        slot="icon-active"
        src="https://cdn.s.bld365.com/getli_tab_icon_01_active.png"
        mode="aspectFit"
      />
      首页
    </van-tabbar-item>
    <van-tabbar-item>
      <image
        slot="icon"
        src="https://cdn.s.bld365.com/getli_tab_icon_02.png"
        mode="aspectFit"
      />
      <image
        slot="icon-active"
        src="https://cdn.s.bld365.com/getli_tab_icon_02_active.png"
        mode="aspectFit"
      />
      统计
    </van-tabbar-item>
    <van-tabbar-item>
      <image
        slot="icon"
        src="https://cdn.s.bld365.com/getli_tab_icon_03.png"
        mode="aspectFit"
      />
      <image
        slot="icon-active"
        src="https://cdn.s.bld365.com/getli_tab_icon_03_active.png"
        mode="aspectFit"
      />
      订单
    </van-tabbar-item>
    <van-tabbar-item>
      <image
        slot="icon"
        src="https://cdn.s.bld365.com/getli_tab_icon_04.png"
        mode="aspectFit"
      />
      <image
        slot="icon-active"
        src="https://cdn.s.bld365.com/getli_tab_icon_04_active.png"
        mode="aspectFit"
      />
      我的
    </van-tabbar-item>
  </van-tabbar>

  <!-- ***************************************模态框*************************************** -->
  <cancelorder id="cancelordermodal"
    show="{{showCancelModal}}"
    bind:onCancel="closeCancelModal"
    bind:onConfirm="confirmCancelModal"
  ></cancelorder>
</view>